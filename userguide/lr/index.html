
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://xin-huang.github.io/gaigar/userguide/lr/">
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../unet/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.40">
    
    
      
        <title>Logistic Regression - gaigar</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#logistic-regression" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="gaigar" class="md-header__button md-logo" aria-label="gaigar" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            gaigar
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Logistic Regression
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/xin-huang/gaigar" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="gaigar" class="md-nav__button md-logo" aria-label="gaigar" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    gaigar
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/xin-huang/gaigar" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Logistic Regression
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Logistic Regression
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulate" class="md-nav__link">
    <span class="md-ellipsis">
      simulate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="simulate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demographic-model" class="md-nav__link">
    <span class="md-ellipsis">
      Demographic model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feature-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Feature configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocess" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess
    </span>
  </a>
  
    <nav class="md-nav" aria-label="preprocess">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_1" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#train" class="md-nav__link">
    <span class="md-ellipsis">
      train
    </span>
  </a>
  
    <nav class="md-nav" aria-label="train">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_2" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infer" class="md-nav__link">
    <span class="md-ellipsis">
      infer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="infer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_3" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    U-Net
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eval/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulate" class="md-nav__link">
    <span class="md-ellipsis">
      simulate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="simulate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demographic-model" class="md-nav__link">
    <span class="md-ellipsis">
      Demographic model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feature-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Feature configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocess" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess
    </span>
  </a>
  
    <nav class="md-nav" aria-label="preprocess">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_1" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#train" class="md-nav__link">
    <span class="md-ellipsis">
      train
    </span>
  </a>
  
    <nav class="md-nav" aria-label="train">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_2" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infer" class="md-nav__link">
    <span class="md-ellipsis">
      infer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="infer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arguments_3" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="logistic-regression">Logistic Regression</h1>
<p><code>gaishi</code> supports logistic regression models for detecting ghost introgressed fragments. To view the subcommand information for logistic regression, users can use:</p>
<div class="codehilite"><pre><span></span><code>gaishi lr -h
</code></pre></div>

<p>This will show information for four subcommands:</p>
<table>
<thead>
<tr>
<th>Subcommand</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>simulate</td>
<td>Simulate data for training</td>
</tr>
<tr>
<td>preprocess</td>
<td>Preprocess data for inference</td>
</tr>
<tr>
<td>train</td>
<td>Train a logistic regression model</td>
</tr>
<tr>
<td>infer</td>
<td>Infer ghost introgressed fragments with a given logistic regression model</td>
</tr>
</tbody>
</table>
<p>To see the arguments for each subcommand, for example, users can use:</p>
<div class="codehilite"><pre><span></span><code>gaishi lr simulate -h
</code></pre></div>

<h2 id="simulate"><code>simulate</code></h2>
<p>Users can utilize the <code>simulate</code> subcommand to generate a training dataset by providing a demographic model in <a href="https://popsim-consortium.github.io/demes-docs/latest/introduction.html">DEMES</a> format and a feature configuration file in YAML format.</p>
<h3 id="demographic-model">Demographic model</h3>
<p>An example DEMES file is available <a href="https://github.com/xin-huang/gaishi/blob/main/examples/demog/ArchIE_3D19.yaml">here</a> and appears as follows:</p>
<div class="codehilite"><pre><span></span><code><span class="nl">doi</span><span class="p">:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">doi</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="mf">10.1371</span><span class="o">/</span><span class="n">journal</span><span class="p">.</span><span class="n">pgen</span><span class="mf">.1008175</span>
<span class="nl">time_units</span><span class="p">:</span><span class="w"> </span><span class="n">generations</span>
<span class="nl">demes</span><span class="p">:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">Ancestral</span>
<span class="w">      </span><span class="nl">epochs</span><span class="p">:</span>
<span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="err">{</span><span class="nl">end_time</span><span class="p">:</span><span class="w"> </span><span class="mi">2500</span><span class="p">,</span><span class="w"> </span><span class="nl">start_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="err">}</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">Source</span>
<span class="w">      </span><span class="nl">ancestors</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Ancestral</span><span class="o">]</span>
<span class="w">      </span><span class="nl">start_time</span><span class="p">:</span><span class="w"> </span><span class="mi">12000</span>
<span class="w">      </span><span class="nl">epochs</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">sriramlab</span><span class="o">/</span><span class="n">ArchIE</span><span class="o">/</span><span class="k">blob</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">simulations</span><span class="o">/</span><span class="n">ms</span><span class="p">.</span><span class="n">sh#L7C48</span><span class="o">-</span><span class="n">L7C179</span>
<span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="err">{</span><span class="nl">end_time</span><span class="p">:</span><span class="w"> </span><span class="mi">6120</span><span class="p">,</span><span class="w"> </span><span class="nl">start_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="err">}</span>
<span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="err">{</span><span class="nl">end_time</span><span class="p">:</span><span class="w"> </span><span class="mi">6000</span><span class="p">,</span><span class="w"> </span><span class="nl">start_size</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="err">}</span>
<span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="err">{</span><span class="nl">end_time</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">start_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="err">}</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">Reference</span>
<span class="w">      </span><span class="nl">ancestors</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Ancestral</span><span class="o">]</span>
<span class="w">      </span><span class="nl">epochs</span><span class="p">:</span>
<span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="err">{</span><span class="nl">end_time</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">start_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="err">}</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">Target</span>
<span class="w">      </span><span class="nl">ancestors</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Ancestral</span><span class="o">]</span>
<span class="w">      </span><span class="nl">epochs</span><span class="p">:</span>
<span class="w">          </span><span class="o">-</span><span class="w"> </span><span class="err">{</span><span class="nl">end_time</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">start_size</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="err">}</span>
<span class="nl">pulses</span><span class="p">:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="err">{</span><span class="nl">sources</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Source</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">dest</span><span class="p">:</span><span class="w"> </span><span class="n">Target</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="err">:</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="nl">proportions</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">0.02</span><span class="o">]</span><span class="err">}</span>
</code></pre></div>

<p>This demographic model, based on the ms command found <a href="https://github.com/sriramlab/ArchIE/blob/master/simulations/ms.sh#L7C48-L7C179">here</a>, includes a population bottleneck in the Source population. It differs from the demographic model depicted in Figure 1 of <a href="https://doi.org/10.1371/journal.pgen.1008175">Durvasula and Sankararaman 2019</a>.</p>
<p>The visualization of this demographic model is illustrated below:</p>
<p><img alt="ArchIE_3D19" src="https://github.com/xin-huang/gaishi/blob/main/examples/demog/ArchIE_3D19.png?raw=true" /></p>
<p>In this diagram, the dashed arrow indicates introgression from the Source population to the Target population, while the Reference population remains unaffected. For ghost introgression scenarios, genomes from the Source population are unavailable.</p>
<h3 id="feature-configuration">Feature configuration</h3>
<p>An example feature configuration file can be found <a href="https://github.com/xin-huang/gaishi/blob/main/examples/features/ArchIE.features.yaml">here</a> and is shown below:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Features</span><span class="o">:</span>
<span class="w">    </span><span class="n">Ref</span><span class="w"> </span><span class="n">distances</span><span class="o">:</span>
<span class="w">        </span><span class="n">Minimum</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="n">Tgt</span><span class="w"> </span><span class="n">distances</span><span class="o">:</span>
<span class="w">        </span><span class="n">All</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="n">Mean</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="n">Variance</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="n">Skew</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="n">Kurtosis</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="n">Spectrum</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="n">Private</span><span class="w"> </span><span class="n">variant</span><span class="w"> </span><span class="n">number</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="n">Sstar</span><span class="o">:</span>
<span class="w">        </span><span class="n">Genotype</span><span class="w"> </span><span class="n">distance</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ArchIE&#39;</span>
<span class="w">        </span><span class="n">Match</span><span class="w"> </span><span class="n">bonus</span><span class="o">:</span><span class="w"> </span><span class="mi">5000</span>
<span class="w">        </span><span class="n">Max</span><span class="w"> </span><span class="n">mismatch</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span>
<span class="w">        </span><span class="n">Mismatch</span><span class="w"> </span><span class="n">penalty</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mi">10000</span>
</code></pre></div>

<p>This file follows the <a href="https://yaml.org/">YAML</a> format and begins with the keyword <code>Features</code>. For each input feature vector, six types of feautures can be estimated:</p>
<ul>
<li>Total variant number: Number of variants that exist in the reference and/or target population for a given sample. </li>
<li>Private variant number: Number of variants that only exist in the target population but not in the reference population for a given sample.</li>
<li>Ref distances: Euclidean distances between the samples in the reference population and a given sample.</li>
<li>Tgt distances: Euclidean distances between the samples in the target population and a given sample.</li>
<li>Spectrum: The spectrum of mutation counts across all samples, based on the mutational sites within a given sample.</li>
<li>Sstar: The S* statistic of a given sample based on the implementation in the <a href="https://github.com/xin-huang/sstar">sstar</a> package.</li>
</ul>
<p>For Ref and Tgt distances, further summary statistics need to be specified. These include:</p>
<ul>
<li>All: Distances between all samples in the specified population (Ref or Tgt) and a given sample.</li>
<li>Minimum: Minimum of all distances.</li>
<li>Maximum: Maximum of all distances.</li>
<li>Mean: Mean of all distances.</li>
<li>Median: Median of all distances.</li>
<li>Variance: Variance of all distances.</li>
<li>Skew: Skew of all distances.</li>
<li>Kurtosis: Kurtosis of all distances.</li>
</ul>
<p>For Sstar, four parameters need to be specified. They are:</p>
<ul>
<li>Genotype distance: Method to calculate genotype distance. Three methods are supported: <code>'ArchIE'</code> (<a href="https://doi.org/10.1371/journal.pgen.1008175">Durvasula and Sankararaman 2019</a>), <code>'Vernot2014'</code> (<a href="https://doi.org/10.1126/science.1245938">Vernot and Akey 2014</a>), and <code>'Vernot2016'</code> (<a href="https://doi.org/10.1126/science.aad9416">Vernot et al. 2016</a>).</li>
<li>Match bonus: Bonus for matching genotypes.</li>
<li>Max mismatch: Maximum allowed mismatches.</li>
<li>Mismatch penalty: Penalty for mismatches.</li>
</ul>
<p>The above example feature configuration file specifies the same features used in the <a href="https://github.com/sriramlab/ArchIE">ArchIE</a> implementation.</p>
<h3 id="example">Example</h3>
<p>To create a training dataset with the above demographic model and feature configuration, use the following command:</p>
<div class="codehilite"><pre><span></span><code>gaishi lr simulate --demes examples/demog/ArchIE_3D19.yaml --nref 5 --ntgt 5 --ref-id Reference --tgt-id Target --src-id Source --seq-len 50000 --phased --mut-rate 1.2e-8 --rec-rate 1e-8 --replicate 100 --output-prefix example.lr --output-dir examples/results/data/training --feature-config examples/features/ArchIE.features.yaml --nfeature 100 --nprocess 2 --seed 12345
</code></pre></div>

<p>In this command, we simulate a dataset with five diploid individuals from the Reference population and another five diploid individuals from the Target population, each with genomes of 50kb length (<code>--seq-len 50000</code>). The length of the simulated genomes in the training dataset should match the window length specified by the <code>--win-len</code> argument in the <code>preprocess</code> subcommand.</p>
<p>The <code>--replicate</code> argument specifies the number of replications per batch for the simulation. The simulation will continue until the number of feature vectors specified by the <code>--nfeature</code> argument is obtained.</p>
<p>The resulting training data can be found <a href="https://github.com/xin-huang/gaishi/blob/main/examples/results/data/training/example.lr.features">here</a> and looks like this:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Chromosome</span><span class="w">  </span><span class="n">Start</span><span class="w">   </span><span class="n">End</span><span class="w"> </span><span class="n">Sample</span><span class="w">  </span><span class="n">Sstar</span><span class="w">   </span><span class="n">Private_var_num</span><span class="w"> </span><span class="mi">0</span><span class="n">_ton</span><span class="w">   </span><span class="mi">1</span><span class="n">_ton</span><span class="w">   </span><span class="mi">2</span><span class="n">_ton</span><span class="w">   </span><span class="mi">3</span><span class="n">_ton</span><span class="w">   </span><span class="mi">4</span><span class="n">_ton</span><span class="w">   </span><span class="mi">5</span><span class="n">_ton</span><span class="w">   </span><span class="mi">6</span><span class="n">_ton</span><span class="w">   </span><span class="mi">7</span><span class="n">_ton</span><span class="w">   </span><span class="mi">8</span><span class="n">_ton</span><span class="w">   </span><span class="mi">9</span><span class="n">_ton</span><span class="w">   </span><span class="mi">10</span><span class="n">_ton</span><span class="w">  </span><span class="n">Minimum_Ref_dist</span><span class="w">    </span><span class="n">Mean_Tgt_dist</span><span class="w">   </span><span class="n">Variance_Tgt_dist</span><span class="w">   </span><span class="n">Skew_Tgt_dist</span><span class="w">   </span><span class="n">Kurtosis_Tgt_dist</span><span class="w">   </span><span class="n">Tgt_dist_tsk_5_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_5_2</span><span class="w">    </span><span class="n">Tgt_dist_tsk_6_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_6_2</span><span class="w">    </span><span class="n">Tgt_dist_tsk_7_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_7_2</span><span class="w">    </span><span class="n">Tgt_dist_tsk_8_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_8_2</span><span class="w">    </span><span class="n">Tgt_dist_tsk_9_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_9_2</span><span class="w">    </span><span class="n">Label</span><span class="w">   </span><span class="n">Replicate</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_5_1</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">2.449489742783178</span><span class="w">   </span><span class="mf">3.48872744842987</span><span class="w">    </span><span class="mf">1.7287807905720076</span><span class="w">  </span><span class="o">-</span><span class="mf">1.6334122781798988</span><span class="w"> </span><span class="mf">2.1947588783962457</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="mf">3.605551275463989</span><span class="w">   </span><span class="mf">3.605551275463989</span><span class="w">   </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">3.872983346207417</span><span class="w">   </span><span class="mf">4.47213595499958</span><span class="w">    </span><span class="mf">4.69041575982343</span><span class="w">    </span><span class="mf">4.898979485566356</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_5_2</span><span class="w"> </span><span class="mf">19649.0</span><span class="w"> </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">2.6457513110645907</span><span class="w">  </span><span class="mf">3.254789503766206</span><span class="w">   </span><span class="mf">2.9063452861733365</span><span class="w">  </span><span class="o">-</span><span class="mf">1.1842207916814167</span><span class="w"> </span><span class="o">-</span><span class="mf">0.16680552852599417</span><span class="w">    </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">4.0</span><span class="w"> </span><span class="mf">4.123105625617661</span><span class="w">   </span><span class="mf">4.358898943540674</span><span class="w">   </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">5.0</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_6_1</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">4</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">3.918161571996715</span><span class="w">   </span><span class="mf">1.948009895728233</span><span class="w">   </span><span class="o">-</span><span class="mf">2.0708242861935697</span><span class="w"> </span><span class="mf">3.330551665081625</span><span class="w">   </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.4641016151377544</span><span class="w">  </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">4.123105625617661</span><span class="w">   </span><span class="mf">4.123105625617661</span><span class="w">   </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.69041575982343</span><span class="w">    </span><span class="mf">5.291502622129181</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_6_2</span><span class="w"> </span><span class="o">-</span><span class="mf">10000.0</span><span class="w">    </span><span class="mi">8</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">6</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">4.242640687119285</span><span class="w">   </span><span class="mf">4.16793656376827</span><span class="w">    </span><span class="mf">2.128304800403537</span><span class="w">   </span><span class="o">-</span><span class="mf">2.255462043427111</span><span class="w">  </span><span class="mf">3.720880027655487</span><span class="w">   </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.4641016151377544</span><span class="w">  </span><span class="mf">4.47213595499958</span><span class="w">    </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mf">4.898979485566356</span><span class="w">   </span><span class="mf">5.291502622129181</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_7_1</span><span class="w"> </span><span class="mf">19649.0</span><span class="w"> </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">2.6457513110645907</span><span class="w">  </span><span class="mf">3.254789503766206</span><span class="w">   </span><span class="mf">2.9063452861733365</span><span class="w">  </span><span class="o">-</span><span class="mf">1.1842207916814167</span><span class="w"> </span><span class="o">-</span><span class="mf">0.16680552852599417</span><span class="w">    </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">4.0</span><span class="w"> </span><span class="mf">4.123105625617661</span><span class="w">   </span><span class="mf">4.358898943540674</span><span class="w">   </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">5.0</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_7_2</span><span class="w"> </span><span class="o">-</span><span class="mf">10000.0</span><span class="w">    </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">2.449489742783178</span><span class="w">   </span><span class="mf">3.1104889980483437</span><span class="w">  </span><span class="mf">2.8248581930202095</span><span class="w">  </span><span class="o">-</span><span class="mf">1.022887702393171</span><span class="w">  </span><span class="o">-</span><span class="mf">0.4271982278872448</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">2.449489742783178</span><span class="w">   </span><span class="mf">3.605551275463989</span><span class="w">   </span><span class="mf">3.605551275463989</span><span class="w">   </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_8_1</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">2.0</span><span class="w"> </span><span class="mf">3.460592909120559</span><span class="w">   </span><span class="mf">1.9242967173445067</span><span class="w">  </span><span class="o">-</span><span class="mf">1.4179730355186297</span><span class="w"> </span><span class="mf">1.1071104397774532</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">2.449489742783178</span><span class="w">   </span><span class="mf">2.449489742783178</span><span class="w">   </span><span class="mf">3.872983346207417</span><span class="w">   </span><span class="mf">3.872983346207417</span><span class="w">   </span><span class="mf">4.0</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_8_2</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">8</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">3.872983346207417</span><span class="w">   </span><span class="mf">4.321617155108232</span><span class="w">   </span><span class="mf">2.2236251646742313</span><span class="w">  </span><span class="o">-</span><span class="mf">2.329450209356624</span><span class="w">  </span><span class="mf">4.126946818082276</span><span class="w">   </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">4.358898943540674</span><span class="w">   </span><span class="mf">4.358898943540674</span><span class="w">   </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.69041575982343</span><span class="w">    </span><span class="mf">5.291502622129181</span><span class="w">   </span><span class="mf">5.291502622129181</span><span class="w">   </span><span class="mf">5.477225575051661</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_9_1</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">5</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">6</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">3.872983346207417</span><span class="w">   </span><span class="mf">4.104968620314319</span><span class="w">   </span><span class="mf">2.2492326262347495</span><span class="w">  </span><span class="o">-</span><span class="mf">1.9035983826633205</span><span class="w"> </span><span class="mf">2.72869867187561</span><span class="w">    </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.605551275463989</span><span class="w">   </span><span class="mf">3.605551275463989</span><span class="w">   </span><span class="mf">3.872983346207417</span><span class="w">   </span><span class="mf">4.69041575982343</span><span class="w">    </span><span class="mf">4.898979485566356</span><span class="w">   </span><span class="mf">4.898979485566356</span><span class="w">   </span><span class="mf">5.0</span><span class="w"> </span><span class="mf">5.0</span><span class="w"> </span><span class="mf">5.477225575051661</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_9_2</span><span class="w"> </span><span class="o">-</span><span class="mf">10000.0</span><span class="w">    </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mf">2.449489742783178</span><span class="w">   </span><span class="mf">3.1104889980483437</span><span class="w">  </span><span class="mf">2.8248581930202095</span><span class="w">  </span><span class="o">-</span><span class="mf">1.022887702393171</span><span class="w">  </span><span class="o">-</span><span class="mf">0.4271982278872448</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">2.449489742783178</span><span class="w">   </span><span class="mf">3.605551275463989</span><span class="w">   </span><span class="mf">3.605551275463989</span><span class="w">   </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span>
</code></pre></div>

<p>The first line is the header, indicating the content of each column. For phased data, an additional number is appended to the sample name. For example, <code>tsk_5_1</code> denotes the first haploid genome from the sample <code>tsk_5</code>. The <code>X_ton</code> column contains the number of sites with <code>X</code> mutations. Following the <a href="https://github.com/sriramlab/ArchIE">ArchIE</a> implementation, the <code>0_ton</code> column (i.e., non-segregating sites) contains only 0s. The <code>Tgt_dist_X</code> column represents the Euclidean distance between sample <code>X</code> and the sample in the current row. For example, the distance between <code>tsk_5_1</code> and <code>tsk_5_2</code> is <code>3</code>. In the <code>Label</code> column, <code>0</code>s represent non-introgressed fragments and <code>1</code>s denote introgressed fragments.</p>
<p>To determine whether a fragment is introgressed or not, the proportion of the length of the introgressed regions to the total length of a given squeuence is estimated.</p>
<p>By default:</p>
<ul>
<li>If the proportion &gt;= 0.7, the fragment is considered as introgressed and labeled as <code>1</code>.</li>
<li>If the proportion &lt;= 0.3, the fragment is considered as non-introgressed and labeled as <code>0</code>.</li>
<li>If 0.3 &lt; the proportion &lt; 0.7, the fragment is labeled as <code>-1</code> and discared in the training dataset.</li>
</ul>
<p>Users can use the <code>--introgressed-prop</code> and <code>--non-introgressed-prop</code> arguments to change the proportions that determine whether a fragment is introgressed or not.</p>
<h3 id="arguments">Arguments</h3>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--demes</code></td>
<td>Demographic model in the DEMES format</td>
</tr>
<tr>
<td><code>--nref</code></td>
<td>Number of samples in the reference population</td>
</tr>
<tr>
<td><code>--ntgt</code></td>
<td>Number of samples in the target population</td>
</tr>
<tr>
<td><code>--ref-id</code></td>
<td>Name of the reference population in the demographic model</td>
</tr>
<tr>
<td><code>--tgt-id</code></td>
<td>Name of the target population in the demographic model</td>
</tr>
<tr>
<td><code>--src-id</code></td>
<td>Name of the source population in the demographic model</td>
</tr>
<tr>
<td><code>--seq-len</code></td>
<td>Length of the simulated genomes</td>
</tr>
<tr>
<td><code>--ploidy</code></td>
<td>Ploidy of the simulated genomes; default: 2</td>
</tr>
<tr>
<td><code>--phased</code></td>
<td>Enable to use phased genotypes; default: False</td>
</tr>
<tr>
<td><code>--mut-rate</code></td>
<td>Mutation rate per base pair per generation for the simulation; default: 1e-8</td>
</tr>
<tr>
<td><code>--rec-rate</code></td>
<td>Recombination rate per base pair per generation for the simulation; default: 1e-8</td>
</tr>
<tr>
<td><code>--replicate</code></td>
<td>Number of replications per batch for the simulation, which will continue until the number of feature vectors specified by the <code>--nfeature</code> argument is obtained; default: 1</td>
</tr>
<tr>
<td><code>--output-prefix</code></td>
<td>Prefix of the output file name</td>
</tr>
<tr>
<td><code>--output-dir</code></td>
<td>Directory of the output files</td>
</tr>
<tr>
<td><code>--feature-config</code></td>
<td>Name of the YAML file specifying what features should be used</td>
</tr>
<tr>
<td><code>--nfeature</code></td>
<td>Number of feature vectors should be generated; default: 1e6</td>
</tr>
<tr>
<td><code>--introgressed-prop</code></td>
<td>Proportion that determines a fragment as introgressed; default: 0.7</td>
</tr>
<tr>
<td><code>--non-introgressed-prop</code></td>
<td>Proportion that determinse a fragment as non-introgressed; default: 0.3</td>
</tr>
<tr>
<td><code>--keep-simulated-data</code></td>
<td>Enable to keep simulated data; default: False</td>
</tr>
<tr>
<td><code>--shuffle-data</code></td>
<td>Enable to shuffle the feature vectors for training; default: False</td>
</tr>
<tr>
<td><code>--force-balanced</code></td>
<td>Enable to ensure a balanced distribution of introgressed and non-introgressed classes in the feature vectors for training; default: False</td>
</tr>
<tr>
<td><code>--nprocess</code></td>
<td>Number of processes for the simulation; default: 1</td>
</tr>
<tr>
<td><code>--seed</code></td>
<td>Random seed for the simulation; default: None</td>
</tr>
</tbody>
</table>
<h2 id="preprocess"><code>preprocess</code></h2>
<p>For real data, users should first use the <code>preprocess</code> subcommand to convert the data into feature vectors. Only <a href="https://samtools.github.io/hts-specs/VCFv4.2.pdf">VCF</a> files are accepted. Additionally, two files specifying the sample names in the reference and target populations are required. An example file can be found <a href="https://github.com/xin-huang/gaishi/blob/main/examples/results/data/test/example.lr.ref.ind.list">here</a> and is shown below:</p>
<div class="codehilite"><pre><span></span><code>tsk_0
tsk_1
tsk_2
tsk_3
tsk_4
</code></pre></div>

<p>In this file, each row records a sample name from the reference population.</p>
<p>Similar to the <code>simulate</code> subcommand, the <code>--feature-config</code> argument specifies a feature configuration as introduced in the <code>simulate</code> section above.</p>
<h3 id="example_1">Example</h3>
<p>An example VCF file can be found <a href="https://github.com/xin-huang/gaishi/blob/main/examples/results/data/test/example.lr.vcf">here</a> and processed by the following command:</p>
<div class="codehilite"><pre><span></span><code>gaishi lr preprocess --vcf examples/results/data/test/example.lr.vcf --chr-name 1 --ref examples/results/data/test/example.lr.ref.ind.list --tgt examples/results/data/test/example.lr.tgt.ind.list --feature-config examples/features/ArchIE.features.yaml --phased --output-prefix example --output-dir examples/results/data/test/ --win-len 50000 --win-step 10000 --nprocess 2
</code></pre></div>

<p>In this command, the genome is divided into 50 kb sliding windows with a step size of 10 kb. The output feature file is available <a href="https://github.com/xin-huang/gaishi/blob/main/examples/results/data/test/example.lr.features">here</a> and looks like:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Chromosome</span><span class="w">  </span><span class="n">Start</span><span class="w">   </span><span class="n">End</span><span class="w"> </span><span class="n">Sample</span><span class="w">  </span><span class="n">Sstar</span><span class="w">   </span><span class="n">Private_var_num</span><span class="w"> </span><span class="mi">0</span><span class="n">_ton</span><span class="w">   </span><span class="mi">1</span><span class="n">_ton</span><span class="w">   </span><span class="mi">2</span><span class="n">_ton</span><span class="w">   </span><span class="mi">3</span><span class="n">_ton</span><span class="w">   </span><span class="mi">4</span><span class="n">_ton</span><span class="w">   </span><span class="mi">5</span><span class="n">_ton</span><span class="w">   </span><span class="mi">6</span><span class="n">_ton</span><span class="w">   </span><span class="mi">7</span><span class="n">_ton</span><span class="w">   </span><span class="mi">8</span><span class="n">_ton</span><span class="w">   </span><span class="mi">9</span><span class="n">_ton</span><span class="w">   </span><span class="mi">10</span><span class="n">_ton</span><span class="w">  </span><span class="n">Minimum_Ref_dist</span><span class="w">    </span><span class="n">Mean_Tgt_dist</span><span class="w">   </span><span class="n">Variance_Tgt_dist</span><span class="w">   </span><span class="n">Skew_Tgt_dist</span><span class="w">   </span><span class="n">Kurtosis_Tgt_dist</span><span class="w">   </span><span class="n">Tgt_dist_tsk_5_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_5_2</span><span class="w">    </span><span class="n">Tgt_dist_tsk_6_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_6_2</span><span class="w">    </span><span class="n">Tgt_dist_tsk_7_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_7_2</span><span class="w">    </span><span class="n">Tgt_dist_tsk_8_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_8_2</span><span class="w">    </span><span class="n">Tgt_dist_tsk_9_1</span><span class="w">    </span><span class="n">Tgt_dist_tsk_9_2</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_5_1</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">7</span><span class="w">   </span><span class="mi">13</span><span class="w">  </span><span class="mi">6</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">4.123105625617661</span><span class="w">   </span><span class="mf">5.309615536704651</span><span class="w">   </span><span class="mf">10.207982852384578</span><span class="w">  </span><span class="o">-</span><span class="mf">0.6658757575588138</span><span class="w"> </span><span class="o">-</span><span class="mf">1.3441196355587541</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="mf">4.69041575982343</span><span class="w">    </span><span class="mf">6.855654600401044</span><span class="w">   </span><span class="mf">7.615773105863909</span><span class="w">   </span><span class="mf">7.874007874011811</span><span class="w">   </span><span class="mf">7.874007874011811</span><span class="w">   </span><span class="mf">8.06225774829855</span><span class="w">    </span><span class="mf">8.12403840463596</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_5_2</span><span class="w"> </span><span class="mf">20140.0</span><span class="w"> </span><span class="mi">8</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">17</span><span class="w">  </span><span class="mi">4</span><span class="w">   </span><span class="mi">6</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">5.0</span><span class="w"> </span><span class="mf">5.85379453278392</span><span class="w">    </span><span class="mf">7.133089567949097</span><span class="w">   </span><span class="o">-</span><span class="mf">0.9046987815683206</span><span class="w"> </span><span class="o">-</span><span class="mf">0.35118286017938694</span><span class="w">    </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.4641016151377544</span><span class="w">  </span><span class="mf">3.872983346207417</span><span class="w">   </span><span class="mf">4.242640687119285</span><span class="w">   </span><span class="mf">6.782329983125268</span><span class="w">   </span><span class="mf">7.681145747868608</span><span class="w">   </span><span class="mf">8.0</span><span class="w"> </span><span class="mf">8.12403840463596</span><span class="w">    </span><span class="mf">8.18535277187245</span><span class="w">    </span><span class="mf">8.18535277187245</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_6_1</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">7</span><span class="w">   </span><span class="mi">13</span><span class="w">  </span><span class="mi">5</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">4.0</span><span class="w"> </span><span class="mf">5.218489072731758</span><span class="w">   </span><span class="mf">11.167371797779243</span><span class="w">  </span><span class="o">-</span><span class="mf">0.6825712521659232</span><span class="w"> </span><span class="o">-</span><span class="mf">1.328941398563287</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mf">6.782329983125268</span><span class="w">   </span><span class="mf">7.54983443527075</span><span class="w">    </span><span class="mf">7.810249675906654</span><span class="w">   </span><span class="mf">7.937253933193772</span><span class="w">   </span><span class="mf">8.12403840463596</span><span class="w">    </span><span class="mf">8.18535277187245</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_6_2</span><span class="w"> </span><span class="mf">8638.0</span><span class="w">  </span><span class="mi">5</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">16</span><span class="w">  </span><span class="mi">3</span><span class="w">   </span><span class="mi">7</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">3.872983346207417</span><span class="w">   </span><span class="mf">5.6313097608129095</span><span class="w">  </span><span class="mf">6.288350377773256</span><span class="w">   </span><span class="o">-</span><span class="mf">1.0075760379692977</span><span class="w"> </span><span class="o">-</span><span class="mf">0.13277253797273136</span><span class="w">    </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.1622776601683795</span><span class="w">  </span><span class="mf">4.123105625617661</span><span class="w">   </span><span class="mf">4.242640687119285</span><span class="w">   </span><span class="mf">6.928203230275509</span><span class="w">   </span><span class="mf">7.14142842854285</span><span class="w">    </span><span class="mf">7.54983443527075</span><span class="w">    </span><span class="mf">7.54983443527075</span><span class="w">    </span><span class="mf">7.615773105863909</span><span class="w">   </span><span class="mf">8.0</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_7_1</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">4</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">9</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">9</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">5.744562646538029</span><span class="w">   </span><span class="mf">6.259153831724486</span><span class="w">   </span><span class="mf">4.622993310808681</span><span class="w">   </span><span class="o">-</span><span class="mf">2.3907418064452797</span><span class="w"> </span><span class="mf">4.226223568170759</span><span class="w">   </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">5.744562646538029</span><span class="w">   </span><span class="mf">6.708203932499369</span><span class="w">   </span><span class="mf">6.782329983125268</span><span class="w">   </span><span class="mf">6.782329983125268</span><span class="w">   </span><span class="mf">6.855654600401044</span><span class="w">   </span><span class="mf">7.14142842854285</span><span class="w">    </span><span class="mf">7.280109889280518</span><span class="w">   </span><span class="mf">7.615773105863909</span><span class="w">   </span><span class="mf">7.681145747868608</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_7_2</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">12</span><span class="w">  </span><span class="mi">2</span><span class="w">   </span><span class="mi">6</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">8</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">3.0</span><span class="w"> </span><span class="mf">6.466955245681272</span><span class="w">   </span><span class="mf">4.978489850355466</span><span class="w">   </span><span class="o">-</span><span class="mf">2.3435056169064628</span><span class="w"> </span><span class="mf">4.113562786769869</span><span class="w">   </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">6.082762530298219</span><span class="w">   </span><span class="mf">6.708203932499369</span><span class="w">   </span><span class="mf">6.782329983125268</span><span class="w">   </span><span class="mf">6.928203230275509</span><span class="w">   </span><span class="mf">7.0710678118654755</span><span class="w">  </span><span class="mf">7.3484692283495345</span><span class="w">  </span><span class="mf">7.874007874011811</span><span class="w">   </span><span class="mf">7.937253933193772</span><span class="w">   </span><span class="mf">7.937253933193772</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_8_1</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">7</span><span class="w">   </span><span class="mi">13</span><span class="w">  </span><span class="mi">5</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">4.0</span><span class="w"> </span><span class="mf">5.218489072731758</span><span class="w">   </span><span class="mf">11.167371797779243</span><span class="w">  </span><span class="o">-</span><span class="mf">0.6825712521659232</span><span class="w"> </span><span class="o">-</span><span class="mf">1.328941398563287</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mf">6.782329983125268</span><span class="w">   </span><span class="mf">7.54983443527075</span><span class="w">    </span><span class="mf">7.810249675906654</span><span class="w">   </span><span class="mf">7.937253933193772</span><span class="w">   </span><span class="mf">8.12403840463596</span><span class="w">    </span><span class="mf">8.18535277187245</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_8_2</span><span class="w"> </span><span class="mf">20140.0</span><span class="w"> </span><span class="mi">9</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">15</span><span class="w">  </span><span class="mi">3</span><span class="w">   </span><span class="mi">7</span><span class="w">   </span><span class="mi">5</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">4.58257569495584</span><span class="w">    </span><span class="mf">5.766933554670999</span><span class="w">   </span><span class="mf">6.94247737600972</span><span class="w">    </span><span class="o">-</span><span class="mf">0.9602798109927838</span><span class="w"> </span><span class="o">-</span><span class="mf">0.34834860197407025</span><span class="w">    </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.1622776601683795</span><span class="w">  </span><span class="mf">3.4641016151377544</span><span class="w">  </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mf">7.280109889280518</span><span class="w">   </span><span class="mf">7.3484692283495345</span><span class="w">  </span><span class="mf">7.810249675906654</span><span class="w">   </span><span class="mf">7.810249675906654</span><span class="w">   </span><span class="mf">7.874007874011811</span><span class="w">   </span><span class="mf">8.12403840463596</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_9_1</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">17</span><span class="w">  </span><span class="mi">4</span><span class="w">   </span><span class="mi">6</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">3.7416573867739413</span><span class="w">  </span><span class="mf">5.873804462206417</span><span class="w">   </span><span class="mf">6.498421139763988</span><span class="w">   </span><span class="o">-</span><span class="mf">1.0258100060151762</span><span class="w"> </span><span class="mf">0.12266501830016008</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">3.872983346207417</span><span class="w">   </span><span class="mf">4.123105625617661</span><span class="w">   </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mf">6.082762530298219</span><span class="w">   </span><span class="mf">7.615773105863909</span><span class="w">   </span><span class="mf">7.937253933193772</span><span class="w">   </span><span class="mf">8.06225774829855</span><span class="w">    </span><span class="mf">8.12403840463596</span><span class="w">    </span><span class="mf">8.12403840463596</span>
<span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">50000</span><span class="w">   </span><span class="n">tsk_9_2</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">1</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">14</span><span class="w">  </span><span class="mi">6</span><span class="w">   </span><span class="mi">2</span><span class="w">   </span><span class="mi">3</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">5.0990195135927845</span><span class="w">  </span><span class="mf">5.91590016026821</span><span class="w">    </span><span class="mf">5.802125293738563</span><span class="w">   </span><span class="o">-</span><span class="mf">1.2380448537795823</span><span class="w"> </span><span class="mf">0.8920223089978263</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">4.69041575982343</span><span class="w">    </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mf">4.795831523312719</span><span class="w">   </span><span class="mf">5.744562646538029</span><span class="w">   </span><span class="mf">7.0710678118654755</span><span class="w">  </span><span class="mf">7.937253933193772</span><span class="w">   </span><span class="mf">8.0</span><span class="w"> </span><span class="mf">8.0</span><span class="w"> </span><span class="mf">8.12403840463596</span>
</code></pre></div>

<p>This output feature file resembles the one generated by the <code>simulate</code> subcommand but without the last two columns: the <code>Label</code> and <code>Replicate</code> columns.</p>
<h3 id="arguments_1">Arguments</h3>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--vcf</code></td>
<td>Name of the VCF file containing genotypes from samples</td>
</tr>
<tr>
<td><code>--chr-name</code></td>
<td>Name of the chromosome in the VCF file for being processed</td>
</tr>
<tr>
<td><code>--ref</code></td>
<td>Name of the file containing population information for samples without introgression</td>
</tr>
<tr>
<td><code>--tgt</code></td>
<td>Name of the file containing population information for samples for detecting ghost introgressed fragments</td>
</tr>
<tr>
<td><code>--feature-config</code></td>
<td>Name of the YAML file specifying what features should be used</td>
</tr>
<tr>
<td><code>--phased</code></td>
<td>Enable to use phased genotypes; default: False</td>
</tr>
<tr>
<td><code>--ploidy</code></td>
<td>Ploidy of genomes; default: 2</td>
</tr>
<tr>
<td><code>--output-prefix</code></td>
<td>Prefix of the output files</td>
</tr>
<tr>
<td><code>--output-dir</code></td>
<td>Directory storing the output files</td>
</tr>
<tr>
<td><code>--win-len</code></td>
<td>Length of the window to calculate statistics as input features; default: 50000</td>
</tr>
<tr>
<td><code>--win-step</code></td>
<td>Step size for moving windows along genomes when calculating statistics; default: 10000</td>
</tr>
<tr>
<td><code>--nprocess</code></td>
<td>Number of processes for the training; default: 1</td>
</tr>
</tbody>
</table>
<h2 id="train"><code>train</code></h2>
<p>Once the training data is created using the <code>simulate</code> subcommand, users can use the <code>train</code> subcommand to train a logsitic regression model.</p>
<h3 id="example_2">Example</h3>
<p>An example command is shown below:</p>
<div class="codehilite"><pre><span></span><code>gaishi lr train --training-data examples/results/data/training/examples.features --model-file examples/results/trained_model/example.lr.model --seed 12345
</code></pre></div>

<p>The trained model, which is a binary file, can be found <a href="https://github.com/xin-huang/gaishi/blob/main/examples/results/trained_model/example.lr.model">here</a>.</p>
<h3 id="arguments_2">Arguments</h3>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--training-data</code></td>
<td>Name of the file containing features to training</td>
</tr>
<tr>
<td><code>--model-file</code></td>
<td>File storing the trained model</td>
</tr>
<tr>
<td><code>--solver</code></td>
<td>default: newton-cg</td>
</tr>
<tr>
<td><code>--penalty</code></td>
<td>default: None</td>
</tr>
<tr>
<td><code>--max-iteration</code></td>
<td>default: 10000</td>
</tr>
<tr>
<td><code>--seed</code></td>
<td>Random seed for the training algorithm; default: None</td>
</tr>
<tr>
<td><code>--scaled</code></td>
<td>Enable to use scaled training data; default: False</td>
</tr>
</tbody>
</table>
<h2 id="infer"><code>infer</code></h2>
<p>Once a trained model is obtained, users can utilize the <code>infer</code> subcommand to make predictions on the features processed by the <code>preprocess</code> subcommand.</p>
<h3 id="example_3">Example</h3>
<p>An example command is shown below:</p>
<div class="codehilite"><pre><span></span><code>gaishi lr infer --inference-data examples/results/data/test/example.lr.features --model-file examples/results/trained_model/example.lr.model --output-file examples/results/inference/example.lr.predictions
</code></pre></div>

<p>The predictions are available <a href="https://github.com/xin-huang/gaishi/blob/main/examples/results/inference/example.lr.predictions">here</a> and appears as follows:</p>
<div class="codehilite"><pre><span></span><code>Chromosome  Start   End Sample  Non_Intro_Prob  Intro_Prob
1   0   50000   tsk_5_1 1.0 1.7830489487120413e-52
1   10000   60000   tsk_5_1 1.0 2.5749749680649507e-43
1   20000   70000   tsk_5_1 1.0 1.579513991055145e-39
1   30000   80000   tsk_5_1 1.0 2.1717524152864808e-52
1   40000   90000   tsk_5_1 1.0 4.148367079845042e-58
1   50000   100000  tsk_5_1 1.0 1.1664135728198555e-44
</code></pre></div>

<p>In this file, the last column represents the probability that a fragment is introgressed, and the second-to-last column represents the probability that a fragment is non-introgressed.</p>
<h3 id="arguments_3">Arguments</h3>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--inference-data</code></td>
<td>Name of the file storing features for inference</td>
</tr>
<tr>
<td><code>--model-file</code></td>
<td>Name of the file storing the trained model</td>
</tr>
<tr>
<td><code>--output-file</code></td>
<td>Name of the output file storing the predictions</td>
</tr>
<tr>
<td><code>--scaled</code></td>
<td>Enable to use scaled inference data; default: False</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>